{"ast":null,"code":"'use strict';\n\nconst MongooseError = require('../../error/mongooseError');\nconst hasDollarKeys = require('./hasDollarKeys');\nconst {\n  trustedSymbol\n} = require('./trusted');\nmodule.exports = function sanitizeFilter(filter) {\n  if (filter == null || typeof filter !== 'object') {\n    return filter;\n  }\n  if (Array.isArray(filter)) {\n    for (const subfilter of filter) {\n      sanitizeFilter(subfilter);\n    }\n    return filter;\n  }\n  const filterKeys = Object.keys(filter);\n  for (const key of filterKeys) {\n    const value = filter[key];\n    if (value?.[trustedSymbol]) {\n      continue;\n    }\n    if (key === '$and' || key === '$or' || key === '$nor') {\n      sanitizeFilter(value);\n      continue;\n    } else if (key === '$jsonSchema' || key === '$where' || key === '$expr' || key === '$text') {\n      throw new MongooseError(key + ' is not allowed with sanitizeFilter');\n    }\n    if (hasDollarKeys(value)) {\n      const keys = Object.keys(value);\n      if (keys.length === 1 && keys[0] === '$eq') {\n        continue;\n      }\n      filter[key] = {\n        $eq: filter[key]\n      };\n    }\n  }\n  return filter;\n};","map":{"version":3,"names":["MongooseError","require","hasDollarKeys","trustedSymbol","module","exports","sanitizeFilter","filter","Array","isArray","subfilter","filterKeys","Object","keys","key","value","length","$eq"],"sources":["C:/Users/bhavn/OneDrive/Desktop/FINSIGHT/node_modules/mongoose/lib/helpers/query/sanitizeFilter.js"],"sourcesContent":["'use strict';\n\nconst MongooseError = require('../../error/mongooseError');\nconst hasDollarKeys = require('./hasDollarKeys');\nconst { trustedSymbol } = require('./trusted');\n\nmodule.exports = function sanitizeFilter(filter) {\n  if (filter == null || typeof filter !== 'object') {\n    return filter;\n  }\n  if (Array.isArray(filter)) {\n    for (const subfilter of filter) {\n      sanitizeFilter(subfilter);\n    }\n    return filter;\n  }\n\n  const filterKeys = Object.keys(filter);\n  for (const key of filterKeys) {\n    const value = filter[key];\n    if (value?.[trustedSymbol]) {\n      continue;\n    }\n    if (key === '$and' || key === '$or' || key === '$nor') {\n      sanitizeFilter(value);\n      continue;\n    } else if (key === '$jsonSchema' || key === '$where' || key === '$expr' || key === '$text') {\n      throw new MongooseError(key + ' is not allowed with sanitizeFilter');\n    }\n\n    if (hasDollarKeys(value)) {\n      const keys = Object.keys(value);\n      if (keys.length === 1 && keys[0] === '$eq') {\n        continue;\n      }\n      filter[key] = { $eq: filter[key] };\n    }\n  }\n\n  return filter;\n};\n"],"mappings":"AAAA,YAAY;;AAEZ,MAAMA,aAAa,GAAGC,OAAO,CAAC,2BAA2B,CAAC;AAC1D,MAAMC,aAAa,GAAGD,OAAO,CAAC,iBAAiB,CAAC;AAChD,MAAM;EAAEE;AAAc,CAAC,GAAGF,OAAO,CAAC,WAAW,CAAC;AAE9CG,MAAM,CAACC,OAAO,GAAG,SAASC,cAAcA,CAACC,MAAM,EAAE;EAC/C,IAAIA,MAAM,IAAI,IAAI,IAAI,OAAOA,MAAM,KAAK,QAAQ,EAAE;IAChD,OAAOA,MAAM;EACf;EACA,IAAIC,KAAK,CAACC,OAAO,CAACF,MAAM,CAAC,EAAE;IACzB,KAAK,MAAMG,SAAS,IAAIH,MAAM,EAAE;MAC9BD,cAAc,CAACI,SAAS,CAAC;IAC3B;IACA,OAAOH,MAAM;EACf;EAEA,MAAMI,UAAU,GAAGC,MAAM,CAACC,IAAI,CAACN,MAAM,CAAC;EACtC,KAAK,MAAMO,GAAG,IAAIH,UAAU,EAAE;IAC5B,MAAMI,KAAK,GAAGR,MAAM,CAACO,GAAG,CAAC;IACzB,IAAIC,KAAK,GAAGZ,aAAa,CAAC,EAAE;MAC1B;IACF;IACA,IAAIW,GAAG,KAAK,MAAM,IAAIA,GAAG,KAAK,KAAK,IAAIA,GAAG,KAAK,MAAM,EAAE;MACrDR,cAAc,CAACS,KAAK,CAAC;MACrB;IACF,CAAC,MAAM,IAAID,GAAG,KAAK,aAAa,IAAIA,GAAG,KAAK,QAAQ,IAAIA,GAAG,KAAK,OAAO,IAAIA,GAAG,KAAK,OAAO,EAAE;MAC1F,MAAM,IAAId,aAAa,CAACc,GAAG,GAAG,qCAAqC,CAAC;IACtE;IAEA,IAAIZ,aAAa,CAACa,KAAK,CAAC,EAAE;MACxB,MAAMF,IAAI,GAAGD,MAAM,CAACC,IAAI,CAACE,KAAK,CAAC;MAC/B,IAAIF,IAAI,CAACG,MAAM,KAAK,CAAC,IAAIH,IAAI,CAAC,CAAC,CAAC,KAAK,KAAK,EAAE;QAC1C;MACF;MACAN,MAAM,CAACO,GAAG,CAAC,GAAG;QAAEG,GAAG,EAAEV,MAAM,CAACO,GAAG;MAAE,CAAC;IACpC;EACF;EAEA,OAAOP,MAAM;AACf,CAAC","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}