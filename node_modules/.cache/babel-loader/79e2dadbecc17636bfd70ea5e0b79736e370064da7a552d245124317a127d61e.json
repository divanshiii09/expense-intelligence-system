{"ast":null,"code":"'use strict';\n\nconst symbols = require('../schema/symbols');\n\n/*!\n * ignore\n */\n\nmodule.exports = function saveSubdocs(schema) {\n  const unshift = true;\n  schema.s.hooks.pre('save', false, saveSubdocsPreSave, null, unshift);\n  schema.s.hooks.post('save', saveSubdocsPostSave, null, unshift);\n  schema.s.hooks.pre('save', saveSubdocsPreDeleteOne);\n  schema.s.hooks.post('save', saveSubdocsPostDeleteOne);\n};\nasync function saveSubdocsPreSave() {\n  if (this.$isSubdocument) {\n    return;\n  }\n  const subdocs = this.$getAllSubdocs({\n    useCache: true\n  });\n  if (!subdocs.length) {\n    return;\n  }\n  const options = this.$__.saveOptions;\n  await Promise.all(subdocs.map(subdoc => subdoc._execDocumentPreHooks('save', options, [options])));\n\n  // Invalidate subdocs cache because subdoc pre hooks can add new subdocuments\n  if (this.$__.saveOptions) {\n    this.$__.saveOptions.__subdocs = null;\n  }\n}\nasync function saveSubdocsPostSave() {\n  if (this.$isSubdocument) {\n    return;\n  }\n  const subdocs = this.$getAllSubdocs({\n    useCache: true\n  });\n  if (!subdocs.length) {\n    return;\n  }\n  const options = this.$__.saveOptions;\n  const promises = [];\n  for (const subdoc of subdocs) {\n    promises.push(subdoc._execDocumentPostHooks('save', options));\n  }\n  await Promise.all(promises);\n}\nasync function saveSubdocsPreDeleteOne() {\n  const removedSubdocs = this.$__.removedSubdocs;\n  if (!removedSubdocs?.length) {\n    return;\n  }\n  const options = this.$__.saveOptions;\n  const promises = [];\n  for (const subdoc of removedSubdocs) {\n    promises.push(subdoc._execDocumentPreHooks('deleteOne', options));\n  }\n  await Promise.all(promises);\n}\nasync function saveSubdocsPostDeleteOne() {\n  const removedSubdocs = this.$__.removedSubdocs;\n  if (!removedSubdocs?.length) {\n    return;\n  }\n  const options = this.$__.saveOptions;\n  const promises = [];\n  for (const subdoc of removedSubdocs) {\n    promises.push(subdoc._execDocumentPostHooks('deleteOne', options));\n  }\n  this.$__.removedSubdocs = null;\n  await Promise.all(promises);\n}\nsaveSubdocsPreSave[symbols.builtInMiddleware] = true;\nsaveSubdocsPostSave[symbols.builtInMiddleware] = true;\nsaveSubdocsPreDeleteOne[symbols.builtInMiddleware] = true;\nsaveSubdocsPostDeleteOne[symbols.builtInMiddleware] = true;","map":{"version":3,"names":["symbols","require","module","exports","saveSubdocs","schema","unshift","s","hooks","pre","saveSubdocsPreSave","post","saveSubdocsPostSave","saveSubdocsPreDeleteOne","saveSubdocsPostDeleteOne","$isSubdocument","subdocs","$getAllSubdocs","useCache","length","options","$__","saveOptions","Promise","all","map","subdoc","_execDocumentPreHooks","__subdocs","promises","push","_execDocumentPostHooks","removedSubdocs","builtInMiddleware"],"sources":["C:/Users/bhavn/OneDrive/Desktop/FINSIGHT/node_modules/mongoose/lib/plugins/saveSubdocs.js"],"sourcesContent":["'use strict';\n\nconst symbols = require('../schema/symbols');\n\n/*!\n * ignore\n */\n\nmodule.exports = function saveSubdocs(schema) {\n  const unshift = true;\n\n  schema.s.hooks.pre('save', false, saveSubdocsPreSave, null, unshift);\n  schema.s.hooks.post('save', saveSubdocsPostSave, null, unshift);\n  schema.s.hooks.pre('save', saveSubdocsPreDeleteOne);\n  schema.s.hooks.post('save', saveSubdocsPostDeleteOne);\n};\n\n\nasync function saveSubdocsPreSave() {\n  if (this.$isSubdocument) {\n    return;\n  }\n\n  const subdocs = this.$getAllSubdocs({ useCache: true });\n\n  if (!subdocs.length) {\n    return;\n  }\n\n  const options = this.$__.saveOptions;\n  await Promise.all(subdocs.map(subdoc => subdoc._execDocumentPreHooks('save', options, [options])));\n\n  // Invalidate subdocs cache because subdoc pre hooks can add new subdocuments\n  if (this.$__.saveOptions) {\n    this.$__.saveOptions.__subdocs = null;\n  }\n}\n\nasync function saveSubdocsPostSave() {\n  if (this.$isSubdocument) {\n    return;\n  }\n\n  const subdocs = this.$getAllSubdocs({ useCache: true });\n\n  if (!subdocs.length) {\n    return;\n  }\n\n  const options = this.$__.saveOptions;\n  const promises = [];\n  for (const subdoc of subdocs) {\n    promises.push(subdoc._execDocumentPostHooks('save', options));\n  }\n\n  await Promise.all(promises);\n}\n\nasync function saveSubdocsPreDeleteOne() {\n  const removedSubdocs = this.$__.removedSubdocs;\n  if (!removedSubdocs?.length) {\n    return;\n  }\n\n  const options = this.$__.saveOptions;\n  const promises = [];\n  for (const subdoc of removedSubdocs) {\n    promises.push(subdoc._execDocumentPreHooks('deleteOne', options));\n  }\n\n  await Promise.all(promises);\n}\n\nasync function saveSubdocsPostDeleteOne() {\n  const removedSubdocs = this.$__.removedSubdocs;\n  if (!removedSubdocs?.length) {\n    return;\n  }\n\n  const options = this.$__.saveOptions;\n  const promises = [];\n  for (const subdoc of removedSubdocs) {\n    promises.push(subdoc._execDocumentPostHooks('deleteOne', options));\n  }\n\n  this.$__.removedSubdocs = null;\n  await Promise.all(promises);\n}\n\n\nsaveSubdocsPreSave[symbols.builtInMiddleware] = true;\nsaveSubdocsPostSave[symbols.builtInMiddleware] = true;\nsaveSubdocsPreDeleteOne[symbols.builtInMiddleware] = true;\nsaveSubdocsPostDeleteOne[symbols.builtInMiddleware] = true;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}